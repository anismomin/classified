{"version":3,"sources":["app/posts/components/createPost.component.ts"],"names":[],"mappings":"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","file":"app/posts/components/createPost.component.js","sourcesContent":["import {Component, EventEmitter} from 'angular2/core'\nimport {Http, Headers, HTTP_PROVIDERS}  from 'angular2/http'\nimport {ControlGroup, FormBuilder, Validators, FORM_DIRECTIVES} from 'angular2/common'\n\nimport { Router } from 'angular2/router'\n\nimport {ControlMessages} from '../../shared/components/control-messages.component'\nimport {ValidationService} from '../../shared/services/validationService'\nimport {PostService} from '../../posts/postService'\n\n@Component({\n    templateUrl: 'app/posts/templates/create.html',\n    directives: [FORM_DIRECTIVES, ControlMessages],\n    providers: [PostService, ValidationService]\n})\nexport class CreatePostComponent {\n\t\n\tpostForm: ControlGroup;\n\tpostingResponse: string;\n\tpostFormProcess = false;\n\tfilesToUpload : any;\n\t\n\n\tconstructor(private fb: FormBuilder, private _http: Http, private _postService: PostService, private _router :Router) {\n\t\t\n\t\tthis.postForm = this.fb.group({\n\t\t\t'title': ['dumytitile', Validators.compose([Validators.required])],\n\t\t\t'price': ['20', Validators.compose([Validators.required])],\n\t\t\t'category': ['mobile', Validators.compose([Validators.required])],\n\t\t\t'description': ['Checkout this description', Validators.compose([Validators.required])],\n\t\t\t'name': ['mynmae', Validators.compose([Validators.required])],\n\t\t\t'phone': ['03343853136', Validators.compose([Validators.required])],\n\t\t\t'images': [''],\n\t\t\t'state': ['sindh', Validators.compose([Validators.required])],\n\t\t\t'city': ['karachi', Validators.compose([Validators.required])]\n\t\t});\n\t}\n\n\tcreatePost(postForm) {\n\n\t\tthis.upload((images) => {\n\t\t\tvar postData = {\n\t\t\t\ttitle: postForm.title,\n\t\t\t\tprice: postForm.price,\n\t\t\t\tcategory: postForm.category,\n\t\t\t\tdescription: postForm.description,\n\t\t\t\tname: postForm.name,\n\t\t\t\tphone: postForm.phone,\n\t\t\t\timages: images,\n\t\t\t\tstate: postForm.state,\n\t\t\t\tcity: postForm.city\n\t\t\t};\n\t\t\t\n\t\t\tthis.postFormProcess = true;\n\t\t\t//JSON.stringify(postData)\n\t\t\tthis._postService.createPost(postData)\n\t\t\t\t.subscribe(\n\t\t\t\tdata => this.postingResponse = JSON.stringify(data),\n\t\t\t\terror => console.log(error),\n\t\t\t\t() => {\n\t\t\t\t\tthis.postFormProcess = false;\n\t\t\t\t\tconsole.log(this.postingResponse);\n\t\t\t\t\tthis._router.navigate(['Posts']);\n\t\t\t\t}\n\t\t\t\t);\n\t\t});\n\n\t}\n\n    upload(cb) {\n        this.makeFileRequest(\"http://localhost:3000/post/upload\", [], this.filesToUpload)\n        .then((result) => {\n\t\t\tvar img = [];\n\t\t\tObject.keys(result).forEach((key) => {\t\n\t\t\t\tvar res = result[key].path.split(\"client\");\t\t\n\t\t\t\timg.push({ path: res[1] });\n\t\t\t\t//console.debug(\"Input File name: \" + result[key].name + \" type:\" + result[key].size + \" size:\" + result[key].size);\n\t\t\t});\n\t\t\tcb(img);\n        }, (error) => {\n            console.debug(error);\n        });\n    }\n\n\tfileChangeEvent(fileInput: any) {\n        this.filesToUpload = fileInput.target.files;\n    }\n\n    makeFileRequest(url: string, params: Array<string>, files: Array<File>) {\n\n        return new Promise((resolve, reject) => {\n            var formData: any = new FormData();\n            var xhr = new XMLHttpRequest();\n            for (var i = 0; i < files.length; i++) {\n                formData.append(\"uploads\", files[i], files[i].name);\n            }\n            xhr.onreadystatechange = function() {\n                if (xhr.readyState == 4) {\n                    if (xhr.status == 200) {\n                        resolve(JSON.parse(xhr.response));\n                    } else {\n                        reject(xhr.response);\n                    }\n                }\n            }\n            xhr.open(\"POST\", url, true);\n            xhr.send(formData);\n        });\n    }\n}\n"],"sourceRoot":"/source/"}